(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,75037,_=>{"use strict";var E,S,A,F=((E={})[E.PartStart=0]="PartStart",E[E.Part=1]="Part",E[E.Complete=2]="Complete",E[E.CompleteAll=3]="CompleteAll",E),T=((S={}).Word="word",S.Cell="cell",S.Slide="slide",S.Draw="draw",S.Pdf="pdf",S),I=((A={})[A.AVS_FILE_UNKNOWN=0]="AVS_FILE_UNKNOWN",A[A.AVS_FILE_DOCUMENT=64]="AVS_FILE_DOCUMENT",A[A.AVS_FILE_DOCUMENT_DOCX=65]="AVS_FILE_DOCUMENT_DOCX",A[A.AVS_FILE_DOCUMENT_DOC=66]="AVS_FILE_DOCUMENT_DOC",A[A.AVS_FILE_DOCUMENT_ODT=67]="AVS_FILE_DOCUMENT_ODT",A[A.AVS_FILE_DOCUMENT_RTF=68]="AVS_FILE_DOCUMENT_RTF",A[A.AVS_FILE_DOCUMENT_TXT=69]="AVS_FILE_DOCUMENT_TXT",A[A.AVS_FILE_DOCUMENT_HTML=70]="AVS_FILE_DOCUMENT_HTML",A[A.AVS_FILE_DOCUMENT_MHT=71]="AVS_FILE_DOCUMENT_MHT",A[A.AVS_FILE_DOCUMENT_EPUB=72]="AVS_FILE_DOCUMENT_EPUB",A[A.AVS_FILE_DOCUMENT_FB2=73]="AVS_FILE_DOCUMENT_FB2",A[A.AVS_FILE_DOCUMENT_MOBI=74]="AVS_FILE_DOCUMENT_MOBI",A[A.AVS_FILE_DOCUMENT_DOCM=75]="AVS_FILE_DOCUMENT_DOCM",A[A.AVS_FILE_DOCUMENT_DOTX=76]="AVS_FILE_DOCUMENT_DOTX",A[A.AVS_FILE_DOCUMENT_DOTM=77]="AVS_FILE_DOCUMENT_DOTM",A[A.AVS_FILE_DOCUMENT_ODT_FLAT=78]="AVS_FILE_DOCUMENT_ODT_FLAT",A[A.AVS_FILE_DOCUMENT_OTT=79]="AVS_FILE_DOCUMENT_OTT",A[A.AVS_FILE_DOCUMENT_DOC_FLAT=80]="AVS_FILE_DOCUMENT_DOC_FLAT",A[A.AVS_FILE_DOCUMENT_DOCX_FLAT=81]="AVS_FILE_DOCUMENT_DOCX_FLAT",A[A.AVS_FILE_DOCUMENT_HTML_IN_CONTAINER=82]="AVS_FILE_DOCUMENT_HTML_IN_CONTAINER",A[A.AVS_FILE_DOCUMENT_DOCX_PACKAGE=84]="AVS_FILE_DOCUMENT_DOCX_PACKAGE",A[A.AVS_FILE_DOCUMENT_OFORM=85]="AVS_FILE_DOCUMENT_OFORM",A[A.AVS_FILE_DOCUMENT_DOCXF=86]="AVS_FILE_DOCUMENT_DOCXF",A[A.AVS_FILE_DOCUMENT_OFORM_PDF=87]="AVS_FILE_DOCUMENT_OFORM_PDF",A[A.AVS_FILE_PRESENTATION=128]="AVS_FILE_PRESENTATION",A[A.AVS_FILE_PRESENTATION_PPTX=129]="AVS_FILE_PRESENTATION_PPTX",A[A.AVS_FILE_PRESENTATION_PPT=130]="AVS_FILE_PRESENTATION_PPT",A[A.AVS_FILE_PRESENTATION_ODP=131]="AVS_FILE_PRESENTATION_ODP",A[A.AVS_FILE_PRESENTATION_PPSX=132]="AVS_FILE_PRESENTATION_PPSX",A[A.AVS_FILE_PRESENTATION_PPTM=133]="AVS_FILE_PRESENTATION_PPTM",A[A.AVS_FILE_PRESENTATION_PPSM=134]="AVS_FILE_PRESENTATION_PPSM",A[A.AVS_FILE_PRESENTATION_POTX=135]="AVS_FILE_PRESENTATION_POTX",A[A.AVS_FILE_PRESENTATION_POTM=136]="AVS_FILE_PRESENTATION_POTM",A[A.AVS_FILE_PRESENTATION_ODP_FLAT=137]="AVS_FILE_PRESENTATION_ODP_FLAT",A[A.AVS_FILE_PRESENTATION_OTP=138]="AVS_FILE_PRESENTATION_OTP",A[A.AVS_FILE_PRESENTATION_PPTX_PACKAGE=139]="AVS_FILE_PRESENTATION_PPTX_PACKAGE",A[A.AVS_FILE_PRESENTATION_ODG=140]="AVS_FILE_PRESENTATION_ODG",A[A.AVS_FILE_SPREADSHEET=256]="AVS_FILE_SPREADSHEET",A[A.AVS_FILE_SPREADSHEET_XLSX=257]="AVS_FILE_SPREADSHEET_XLSX",A[A.AVS_FILE_SPREADSHEET_XLS=258]="AVS_FILE_SPREADSHEET_XLS",A[A.AVS_FILE_SPREADSHEET_ODS=259]="AVS_FILE_SPREADSHEET_ODS",A[A.AVS_FILE_SPREADSHEET_CSV=260]="AVS_FILE_SPREADSHEET_CSV",A[A.AVS_FILE_SPREADSHEET_XLSM=261]="AVS_FILE_SPREADSHEET_XLSM",A[A.AVS_FILE_SPREADSHEET_XLTX=262]="AVS_FILE_SPREADSHEET_XLTX",A[A.AVS_FILE_SPREADSHEET_XLTM=263]="AVS_FILE_SPREADSHEET_XLTM",A[A.AVS_FILE_SPREADSHEET_XLSB=264]="AVS_FILE_SPREADSHEET_XLSB",A[A.AVS_FILE_SPREADSHEET_ODS_FLAT=265]="AVS_FILE_SPREADSHEET_ODS_FLAT",A[A.AVS_FILE_SPREADSHEET_OTS=266]="AVS_FILE_SPREADSHEET_OTS",A[A.AVS_FILE_SPREADSHEET_XLSX_FLAT=267]="AVS_FILE_SPREADSHEET_XLSX_FLAT",A[A.AVS_FILE_SPREADSHEET_XLSX_PACKAGE=268]="AVS_FILE_SPREADSHEET_XLSX_PACKAGE",A[A.AVS_FILE_CROSSPLATFORM=512]="AVS_FILE_CROSSPLATFORM",A[A.AVS_FILE_CROSSPLATFORM_PDF=513]="AVS_FILE_CROSSPLATFORM_PDF",A[A.AVS_FILE_CROSSPLATFORM_SWF=514]="AVS_FILE_CROSSPLATFORM_SWF",A[A.AVS_FILE_CROSSPLATFORM_DJVU=515]="AVS_FILE_CROSSPLATFORM_DJVU",A[A.AVS_FILE_CROSSPLATFORM_XPS=516]="AVS_FILE_CROSSPLATFORM_XPS",A[A.AVS_FILE_CROSSPLATFORM_SVG=517]="AVS_FILE_CROSSPLATFORM_SVG",A[A.AVS_FILE_CROSSPLATFORM_HTMLR=518]="AVS_FILE_CROSSPLATFORM_HTMLR",A[A.AVS_FILE_CROSSPLATFORM_HTMLR_MENU=519]="AVS_FILE_CROSSPLATFORM_HTMLR_MENU",A[A.AVS_FILE_CROSSPLATFORM_HTMLR_CANVAS=520]="AVS_FILE_CROSSPLATFORM_HTMLR_CANVAS",A[A.AVS_FILE_CROSSPLATFORM_PDFA=521]="AVS_FILE_CROSSPLATFORM_PDFA",A[A.AVS_FILE_IMAGE=1024]="AVS_FILE_IMAGE",A[A.AVS_FILE_IMAGE_JPG=1025]="AVS_FILE_IMAGE_JPG",A[A.AVS_FILE_IMAGE_TIFF=1026]="AVS_FILE_IMAGE_TIFF",A[A.AVS_FILE_IMAGE_TGA=1027]="AVS_FILE_IMAGE_TGA",A[A.AVS_FILE_IMAGE_GIF=1028]="AVS_FILE_IMAGE_GIF",A[A.AVS_FILE_IMAGE_PNG=1029]="AVS_FILE_IMAGE_PNG",A[A.AVS_FILE_IMAGE_EMF=1030]="AVS_FILE_IMAGE_EMF",A[A.AVS_FILE_IMAGE_WMF=1031]="AVS_FILE_IMAGE_WMF",A[A.AVS_FILE_IMAGE_BMP=1032]="AVS_FILE_IMAGE_BMP",A[A.AVS_FILE_IMAGE_CR2=1033]="AVS_FILE_IMAGE_CR2",A[A.AVS_FILE_IMAGE_PCX=1034]="AVS_FILE_IMAGE_PCX",A[A.AVS_FILE_IMAGE_RAS=1035]="AVS_FILE_IMAGE_RAS",A[A.AVS_FILE_IMAGE_PSD=1036]="AVS_FILE_IMAGE_PSD",A[A.AVS_FILE_IMAGE_ICO=1037]="AVS_FILE_IMAGE_ICO",A[A.AVS_FILE_OTHER=2048]="AVS_FILE_OTHER",A[A.AVS_FILE_OTHER_EXTRACT_IMAGE=2049]="AVS_FILE_OTHER_EXTRACT_IMAGE",A[A.AVS_FILE_OTHER_MS_OFFCRYPTO=2050]="AVS_FILE_OTHER_MS_OFFCRYPTO",A[A.AVS_FILE_OTHER_HTMLZIP=2051]="AVS_FILE_OTHER_HTMLZIP",A[A.AVS_FILE_OTHER_OLD_DOCUMENT=2052]="AVS_FILE_OTHER_OLD_DOCUMENT",A[A.AVS_FILE_OTHER_OLD_PRESENTATION=2053]="AVS_FILE_OTHER_OLD_PRESENTATION",A[A.AVS_FILE_OTHER_OLD_DRAWING=2054]="AVS_FILE_OTHER_OLD_DRAWING",A[A.AVS_FILE_OTHER_OOXML=2055]="AVS_FILE_OTHER_OOXML",A[A.AVS_FILE_OTHER_JSON=2056]="AVS_FILE_OTHER_JSON",A[A.AVS_FILE_OTHER_ODF=2058]="AVS_FILE_OTHER_ODF",A[A.AVS_FILE_OTHER_MS_MITCRYPTO=2059]="AVS_FILE_OTHER_MS_MITCRYPTO",A[A.AVS_FILE_OTHER_MS_VBAPROJECT=2060]="AVS_FILE_OTHER_MS_VBAPROJECT",A[A.AVS_FILE_OTHER_PACKAGE_IN_OLE=2061]="AVS_FILE_OTHER_PACKAGE_IN_OLE",A[A.AVS_FILE_TEAMLAB=4096]="AVS_FILE_TEAMLAB",A[A.AVS_FILE_TEAMLAB_DOCY=4097]="AVS_FILE_TEAMLAB_DOCY",A[A.AVS_FILE_TEAMLAB_XLSY=4098]="AVS_FILE_TEAMLAB_XLSY",A[A.AVS_FILE_TEAMLAB_PPTY=4099]="AVS_FILE_TEAMLAB_PPTY",A[A.AVS_FILE_CANVAS=8192]="AVS_FILE_CANVAS",A[A.AVS_FILE_CANVAS_WORD=8193]="AVS_FILE_CANVAS_WORD",A[A.AVS_FILE_CANVAS_SPREADSHEET=8194]="AVS_FILE_CANVAS_SPREADSHEET",A[A.AVS_FILE_CANVAS_PRESENTATION=8195]="AVS_FILE_CANVAS_PRESENTATION",A[A.AVS_FILE_CANVAS_PDF=8196]="AVS_FILE_CANVAS_PDF",A[A.AVS_FILE_DRAW=16384]="AVS_FILE_DRAW",A[A.AVS_FILE_DRAW_VSDX=16385]="AVS_FILE_DRAW_VSDX",A[A.AVS_FILE_DRAW_VSSX=16386]="AVS_FILE_DRAW_VSSX",A[A.AVS_FILE_DRAW_VSTX=16387]="AVS_FILE_DRAW_VSTX",A[A.AVS_FILE_DRAW_VSDM=16388]="AVS_FILE_DRAW_VSDM",A[A.AVS_FILE_DRAW_VSSM=16389]="AVS_FILE_DRAW_VSSM",A[A.AVS_FILE_DRAW_VSTM=16390]="AVS_FILE_DRAW_VSTM",A);_.s(["AscSaveTypes",()=>F,"AvsFileType",()=>I,"DocumentType",()=>T])},7064,_=>{"use strict";var E=_.i(75037);let S=self.location.origin+"/x2t-1/",A=null,F=null;async function T(){if(!A){Object.assign(self,{__filename:S}),importScripts(S+"x2t.js"),A=self.Module,await new Promise(_=>{A.onRuntimeInitialized=()=>_()});try{A.FS.mkdir("/working"),A.FS.mkdir("/working/media"),A.FS.mkdir("/working/fonts"),A.FS.mkdir("/working/themes")}catch(_){console.error("[x2t.worker] mkdir error:",_)}console.log("[x2t.worker] Initialized successfully")}}async function I(){return F||(F=T()),F}function L(){try{for(let _ of A.FS.readdir("/working/media/"))"."!==_&&".."!==_&&A.FS.unlink("/working/media/"+_)}catch(_){console.error(_)}}I().catch(_=>{console.error("[x2t.worker] Auto-init failed:",_)});let O="/working/params.xml";function V({fileFrom:_,fileTo:S,formatFrom:F,formatTo:T,data:I,media:V}){let e=Object.entries({m_sFileFrom:_,m_sThemeDir:"/working/themes",m_sFileTo:S,m_nFormatFrom:F,m_nFormatTo:T,m_bIsPDFA:T===E.AvsFileType.AVS_FILE_CROSSPLATFORM_PDFA,m_bIsNoBase64:!1,m_sFontDir:"/working/fonts/"}).filter(([_,E])=>E).reduce((_,[E,S])=>_+`<${E}>${S}</${E}>
`,""),M=`<?xml version="1.0" encoding="utf-8"?>
<TaskQueueDataConvert
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema"
>
${e}
</TaskQueueDataConvert>`;if(A.FS.writeFile(O,M),I&&A.FS.writeFile(_,new Uint8Array(I)),V)for(let[_,E]of(L(),Object.entries(V)))try{A.FS.writeFile("/working/"+_,E)}catch(E){console.error(_,E)}}async function e({data:_,fileFrom:S,fileTo:F,formatFrom:T,formatTo:I,media:e,fonts:M,themes:R}){let P="/working/"+S,r="/working/"+F,D=[P,r,O];if(V({fileFrom:P,fileTo:r,formatFrom:T,formatTo:I,data:_,media:e}),S.endsWith(".doc")||T==E.AvsFileType.AVS_FILE_DOCUMENT_DOC){let _=P+".docx";V({fileFrom:P,fileTo:_,data:null}),A.ccall("main1",["number"],["string"],[O]),V({fileFrom:_,fileTo:r,data:null}),D.push(_)}try{A.FS.analyzePath(r).exists&&A.FS.unlink(r)}catch(_){}try{A.ccall("main1",["number"],["string"],[O])}catch(_){console.error("ccall",_)}let N=null;try{N=A.FS.readFile(r)}catch(_){console.error(_)}let t=function(){let _={};try{for(let E of A.FS.readdir("/working/media/"))if("."!==E&&".."!==E){let S=A.FS.readFile("/working/media/"+E,{encoding:"binary"});_[E]=S}}catch(_){console.error(_)}return _}();return setTimeout(()=>{for(let _ of D)try{A.FS.unlink(_)}catch(_){console.error(_)}L()}),{output:N,media:t}}self.onmessage=async _=>{let{id:E,type:S,payload:A}=_.data;try{if("convert"===S){await I();let _=await e(A),S=[];_.output&&S.push(_.output.buffer),Object.values(_.media).forEach(_=>S.push(_.buffer)),self.postMessage({id:E,type:"convert:done",payload:_},{transfer:S})}else self.postMessage({id:E,type:"error",error:`Unknown message type: ${S}`})}catch(_){self.postMessage({id:E,type:"error",error:_ instanceof Error?_.message:String(_)})}},self.postMessage({type:"ready"}),_.s([])}]);