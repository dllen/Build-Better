(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4175,(e,t,n)=>{"use strict";var r=Object.prototype.hasOwnProperty,s="~";function o(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function c(e,t,n,r,o){if("function"!=typeof n)throw TypeError("The listener must be a function");var c=new i(n,r||e,o),a=s?s+t:t;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],c]:e._events[a].push(c):(e._events[a]=c,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function l(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(s=!1)),l.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(s?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},l.prototype.listeners=function(e){var t=s?s+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,i=Array(o);r<o;r++)i[r]=n[r].fn;return i},l.prototype.listenerCount=function(e){var t=s?s+e:e,n=this._events[t];return n?n.fn?1:n.length:0},l.prototype.emit=function(e,t,n,r,o,i){var c=s?s+e:e;if(!this._events[c])return!1;var a,l,u=this._events[c],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,r),!0;case 5:return u.fn.call(u.context,t,n,r,o),!0;case 6:return u.fn.call(u.context,t,n,r,o,i),!0}for(l=1,a=Array(d-1);l<d;l++)a[l-1]=arguments[l];u.fn.apply(u.context,a)}else{var h,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),d){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,n);break;case 4:u[l].fn.call(u[l].context,t,n,r);break;default:if(!a)for(h=1,a=Array(d-1);h<d;h++)a[h-1]=arguments[h];u[l].fn.apply(u[l].context,a)}}return!0},l.prototype.on=function(e,t,n){return c(this,e,t,n,!1)},l.prototype.once=function(e,t,n){return c(this,e,t,n,!0)},l.prototype.removeListener=function(e,t,n,r){var o=s?s+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var i=this._events[o];if(i.fn)i.fn!==t||r&&!i.once||n&&i.context!==n||a(this,o);else{for(var c=0,l=[],u=i.length;c<u;c++)(i[c].fn!==t||r&&!i[c].once||n&&i[c].context!==n)&&l.push(i[c]);l.length?this._events[o]=1===l.length?l[0]:l:a(this,o)}return this},l.prototype.removeAllListeners=function(e){var t;return e?(t=s?s+e:e,this._events[t]&&a(this,t)):(this._events=new o,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=s,l.EventEmitter=l,t.exports=l},38041,e=>{"use strict";var t=e.i(52808),n=e.i(80245),r=e.i(2679),s=e.i(81584);e.i(9458);var o=e.i(4175);o.default;class i{static _staticEmitter=new o.default;static on(e,t){i._staticEmitter.on(e,t)}static off(e,t){i._staticEmitter.off(e,t)}active=!0;connected=!1;disconnected=!0;recovered=!1;id="";io={setOpenToken:()=>{},setSessionToken:()=>{},on:()=>{},reconnectionAttempts:()=>{},reconnectionDelay:()=>{},reconnectionDelayMax:()=>{},timeout:()=>{},transports:()=>{},upgrade:()=>{},upgradeTransport:()=>{},upgradeTimeout:()=>{}};_clientEmitter=new o.default;_serverEmitter=new o.default;_debug;constructor(e={}){this._debug=e.debug??!1,this.connect()}_log(...e){this._debug&&console.log("[MockSocket]",...e)}open(){return this.connect()}compress(){}connect(){return this.connected=!0,this.disconnected=!1,this.id=Math.random().toString(36).substring(2,15),setTimeout(()=>{this._trigger("connect"),i._staticEmitter.emit("connect",{socket:this})},0),this}disconnect(){return this.connected=!1,this.disconnected=!0,this._trigger("disconnect"),i._staticEmitter.emit("disconnect",{socket:this}),this}close(){return this.disconnect()}_trigger(e,...t){return this._log(`trigger event: ${e}`,...t),this._clientEmitter.emit(e,...t),this}on(e,t){return this._clientEmitter.on(e,t),this}once(e,t){return this._clientEmitter.once(e,t),this}off(e,t){return this._clientEmitter.off(e,t),this}removeAllListeners(e){return this._clientEmitter.removeAllListeners(e),this}send(...e){return this.connected&&this.emit("message",...e),this}emit(e,...t){if(this._log(`emit: ${e}`,...t),!this.connected)return this;let n=async()=>{this._serverEmitter.emit(e,...t)};return setTimeout(()=>n(),0),this}server={on:(e,t)=>{this._serverEmitter.on(e,t)},off:(e,t)=>{this._serverEmitter.off(e,t)},emit:(e,...t)=>{this._clientEmitter.emit(e,...t)}}}let c=function(e,t){return new i(t)},a="/v9.3.0.24-1";function l({params:e}){let o=(0,r.useAppStore)(e=>e.server),l=(0,r.useResolvedLanguage)(),u=(0,r.useAppStore)(e=>e.theme),d=(0,n.useRef)(!1);return(0,n.useEffect)(()=>{let e=e=>{d.current&&(e.preventDefault(),e.returnValue="")};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[]),(0,n.useLayoutEffect)(()=>{let e=a+"/web-apps/apps/api/documents/api.js",t=new URLSearchParams(window.location.search),n=t.get("fileId"),r=t.get("new");!n&&r&&o.openNew(r);let h=o.getDocument(),p=o.getUser(),f=(0,s.getDocumentType)(h.fileType);console.log("editor: ",h,p,f);let v=null;i.on("connect",o.handleConnect),i.on("disconnect",o.handleDisconnect);let g=()=>(v=new window.DocsAPI.DocEditor("placeholder",{document:{fileType:h.fileType,key:h.key,title:h.title,url:h.url,permissions:{edit:!0,chat:!1,rename:!0,protect:!0,review:!1}},documentType:f,editorConfig:{lang:l,coEditing:{mode:"fast",change:!1},user:{...p},customization:{uiTheme:u,features:{spellcheck:{change:!1}},logo:{visible:!1}}},events:{onAppReady:async t=>{console.log("App ready",t,v),(()=>{let t=document.querySelector('iframe[name="frameEditor"]'),n=t?.contentWindow,r=t?.contentDocument;if(!r||!n)throw Error("Iframe not loaded");let s=function(e=globalThis.XMLHttpRequest){return class t extends e{static _middlewares=[];_isMocked=!1;_requestMethod="GET";_requestUrl="";_requestHeaders=new Headers;_requestBody=null;static use(e){this._middlewares.push(e)}static clearMiddlewares(){this._middlewares=[]}open(e,t,n=!0,r,s){this._requestMethod=e,this._requestUrl=t.toString(),this._requestHeaders=new Headers,this._isMocked=!1,super.open(e,t,n,r??void 0,s??void 0)}setRequestHeader(e,t){this._requestHeaders.append(e,t),this._isMocked||super.setRequestHeader(e,t)}send(e){this._requestBody=e,this._tryMiddlewares().then(t=>{t||super.send(e)}).catch(t=>{console.error("ProxyXMLHttpRequest middleware error:",t),super.send(e)})}async _tryMiddlewares(){let e;try{let t={method:this._requestMethod,headers:this._requestHeaders,body:this._requestBody,mode:"cors"};this.withCredentials&&(t.credentials="include"),e=new Request(this._requestUrl,t)}catch(e){return!1}for(let n of t._middlewares){let t=await n(e.clone());if(t)return this._isMocked=!0,await this._handleMockResponse(t),!0}return!1}async _handleMockResponse(e){this.dispatchEvent(new ProgressEvent("loadstart")),Object.defineProperty(this,"readyState",{value:2,writable:!1,configurable:!0}),this.dispatchEvent(new Event("readystatechange")),Object.defineProperty(this,"readyState",{value:3,writable:!1,configurable:!0}),this.dispatchEvent(new Event("readystatechange"));try{let t;if("json"===this.responseType)t=await e.json();else if("arraybuffer"===this.responseType)t=await e.arrayBuffer();else if("blob"===this.responseType)t=await e.blob();else if("document"===this.responseType){let n=await e.text();t=new DOMParser().parseFromString(n,"text/xml")}else t=await e.text();Object.defineProperty(this,"status",{value:e.status,writable:!1,configurable:!0}),Object.defineProperty(this,"statusText",{value:e.statusText,writable:!1,configurable:!0}),Object.defineProperty(this,"response",{value:t,writable:!1,configurable:!0}),Object.defineProperty(this,"responseText",{value:"string"==typeof t?t:JSON.stringify(t),writable:!1,configurable:!0}),Object.defineProperty(this,"responseURL",{value:e.url,writable:!1,configurable:!0}),this.dispatchEvent(new ProgressEvent("progress",{lengthComputable:!0,loaded:100,total:100})),Object.defineProperty(this,"readyState",{value:4,writable:!1,configurable:!0}),this.dispatchEvent(new Event("readystatechange")),this.dispatchEvent(new ProgressEvent("load")),this.dispatchEvent(new ProgressEvent("loadend"))}catch(e){console.error("ProxyXHR: error handling response",e),Object.defineProperty(this,"readyState",{value:4,writable:!1,configurable:!0}),this.dispatchEvent(new Event("readystatechange")),this.dispatchEvent(new ProgressEvent("error")),this.dispatchEvent(new ProgressEvent("loadend"))}}}}(n.XMLHttpRequest),i=n.Worker;s.use(e=>o.handleRequest(e)),Object.assign(n,{io:c,XMLHttpRequest:s,Worker:function(e,t){let n=new URL(e,location.origin);return new i(n.href.replace(n.origin,location.origin),t)}});let a=r.createElement("script");a.src=e,r.body.appendChild(a)})()},onDocumentReady:e=>{console.log("Document ready",e)},onDocumentStateChange:e=>{console.log("Document state change",e),e.data&&(d.current=!0)},onRequestOpen:e=>{console.log("onRequestOpen",e)},onError:e=>{console.log("Error",e)},onInfo:e=>{console.log("Info",e)},onWarning:e=>{console.log("onWarning",e)},onRequestSaveAs:e=>{console.log("onRequestSaveAs",e)},onSaveDocument:e=>{console.log("onSaveDocument",e),d.current=!1},onDownloadAs:e=>{console.log("onDownloadAs",e)},onSave:e=>{console.log("onSave",e),d.current=!1},writeFile:async e=>{console.log("writeFile",e),d.current=!1}},width:"100%",height:"100%"}),Object.assign(window,{editor:v}),v);return(async()=>{window.DocsAPI&&window.DocsAPI.DocEditor&&g();let t=document.querySelector(`script[src="${e}"]`);t||((t=document.createElement("script")).src=e,document.head.appendChild(t)),t.onload=()=>{g()},t.onerror=e=>{console.error("Failed to load DocsAPI script",e)}})(),()=>{i.off("connect",o.handleConnect),i.off("disconnect",o.handleDisconnect),v?.destroyEditor?.()}},[]),(0,t.jsx)("div",{children:(0,t.jsx)("div",{className:"w-screen h-screen",children:(0,t.jsx)("div",{id:"placeholder",children:(0,t.jsx)("iframe",{className:"w-0 h-0 hidden",src:a+"/web-apps/apps/api/documents/preload.html"})})})})}e.s(["default",()=>l],38041)}]);